<h2>Admin Panel</h2>

<button onclick="loadUsers()">Refresh</button>

<table>
<thead>
<tr>
<th>ID</th>
<th>Name</th>
<th>Email</th>
<th>Phone</th>
<th>Status</th>
<th>Password</th>
<th>Actions</th>
</tr>
</thead>
<tbody id="body"></tbody>
</table>

<script>
function loadUsers(){
fetch('/api/users')
.then(res=>res.json())
.then(data=>{
let html='';
data.forEach(u=>{
html+=`
<tr>
<td>${u.salesforce_id}</td>
<td>${u.firstname} ${u.lastname}</td>
<td>${u.emailid}</td>
<td>${u.phone||''}</td>
<td>${u.status}</td>
<td>
<button onclick="setPassword('${u.salesforce_id}')">Set/Reset</button>
</td>
<td>
<button onclick="toggleStatus('${u.salesforce_id}','Active')">Activate</button>
<button onclick="toggleStatus('${u.salesforce_id}','Inactive')">Deactivate</button>
</td>
</tr>`;
});
document.getElementById('body').innerHTML=html;
});
}

function setPassword(id){
let pwd=prompt("Enter New Password:");
fetch('/api/set-password',{
method:'POST',
headers:{'Content-Type':'application/json'},
body:JSON.stringify({salesforce_id:id,new_password:pwd})
}).then(()=>alert("Password Updated"));
}

function toggleStatus(id,status){
fetch('/api/toggle-status',{
method:'POST',
headers:{'Content-Type':'application/json'},
body:JSON.stringify({salesforce_id:id,status})
}).then(()=>loadUsers());
}

loadUsers();
</script>
